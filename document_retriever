class DocumentRetriever:
    def __init__(self, index, tokenized_docs, line_index=None):
        self.index = index
        self.docs = tokenized_docs
        self.line_index = line_index or {}

    def query(self, keywords):
        result_scores = {}
        for doc_name, tokens in self.docs.items():
            score = sum(tokens.count(k) for k in keywords)
            if score > 0:
                result_scores[doc_name] = score
        return sorted(result_scores.items(), key=lambda x: x[1], reverse=True)

    def get_lines_with_keywords(self, keywords):
        results = []
        for keyword in keywords:
            if keyword in self.line_index:
                for doc, line_num, line in self.line_index[keyword]:
                    results.append((keyword, doc, line_num, line))
        return results
